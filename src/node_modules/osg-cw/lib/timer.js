var log = require('osg-logger').of('cw:timer')
    ;
    
module.exports = function timer(callback) {

    var DEFAULT_DELAY = 60000,
        callbacks = [],
        interval
        ;

    function start(delay) {
        delay = Number(delay) && delay >= DEFAULT_DELAY ? delay : DEFAULT_DELAY
        interval = setInterval(function () {
            call();
        }, delay)
    }
    function stop(reset) {
        clearInterval(interval);
        interval = null;
        if (reset) callbacks.length = 0;
    }
    function call() {
        callbacks.map(function (ck) {
            ck();
        });
        if (typeof callback === 'function') callback();
    }
    function register(ck) {
        callbacks.push(ck);
    }

    return {
        start: start,
        stop: stop,
        register: register
    };
};